{% extends "layout.html" %}

  <!-- Custom CSS, JavaScript, Title -->
  {% block custom_css %} <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}"> {% endblock %}
  {% block js %} <script src="{{ url_for('static', filename='js/book.js') }}"></script> {% endblock %}
  {% block title %} <title>CS50 - Book Reviews w/Goodreads - Index</title> {% endblock %}

  <!-- Body -->
{% block body %}
<div class="container">

  <!-- Header & Logo -->
  <div id="header-background-wrapper">
    <div id="header-background">
      <img id="header-logo" src="{{ url_for('static', filename='img/book-review-logo-01.svg') }}">
    </div>
  </div>

  <!-- Search Bar -->
  <form action="/" method="post">
    <nav id="navbar">
      <div class="row p-3">
        <div class="input-group">
          <input type="text" class="form-control" name="search_bar" placeholder="Search books" aria-label="Search books">
          <input value="5" type="hidden" id="results_limit" name="results_limit">
          <div class="input-group-append">
            <button class="btn" type="submit"><span class="fas fa-search"></span></button>
            <button class="btn dropdown-toggle" id="dropdown-selection" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Show 5 Results</button>
            <div class="dropdown-menu">
              <a class="dropdown-item" data-results="5" id="show-5-results" href="#">Show 5 Results</a>
              <a class="dropdown-item" data-results="10" id="show-10-results" href="#">Show 10 Results</a>
              <a class="dropdown-item" data-results="20" id="show-20-results" href="#">Show 20 Results</a>
              <div role="separator" class="dropdown-divider"></div>
              <a class="dropdown-item" data-results="42" id="show-all-results" href="#">Show All</a>
            </div>
          </div>
        </div>
      </div>
    </nav>
  </form>

  <div class="row mt-3">

    <!-- User Panel/Logout -->
    <div class="col-md-3 mr-auto" id="user-panel">
      <h5>Welcome, {{ user }}!</h5>
      <a href="{{ url_for('logout')}}">Logout</a>
    </div>

    <!-- Book Reviews -->
    <div class="col-md-8 mt-3 mt-md-0" id="book-reviews">
      <p>
        <h5>Information:</h5>
        Title: {{ specific_book[0].title }}<br>
        Author: {{ specific_book[0].author }}<br>
        Year: {{ specific_book[0].year }}<br>
        ISBN: {{ specific_book[0].isbn }}
      </p>

      <p>
        <h5>Reviews:</h5>
        <ul>
        {% for user_review in user_reviews: %}
          <li>{{ user_review.username }}: {{ user_review.review }}</li>
        {% endfor %}
        </ul>
      </p>

      <p>
        Average rating: {{ ratings_avg }} / 5.0
      </p>

      <p>
        <h5>Goodreads reviews:</h5>
        Average rating: {{ goodreads_response_json_avg }}<br>
        Number of reviews: {{ goodreads_response_json_count }}
      </p>

      <!-- User submitted reviews -->
      <p>
        <h5>Write a review & rate this book:</h5>
        <form action="{{ url_for('book', book_id=book_id) }}" method="post">
          <div>
            <textarea style="width: 100%" type="text" name="write_review" rows="4"></textarea>
          </div>

          <div class="center-div-wrapper">
            <!-- <select name="rating">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select> -->

            <input value="5" type="hidden" id="rating-selection" name="rating-selection">

            <span class="far fa-star rating-stars" id="star-1" data-rating="1"></span>
            <span class="far fa-star rating-stars" id="star-2" data-rating="2"></span>
            <span class="far fa-star rating-stars" id="star-3" data-rating="3"></span>
            <span class="far fa-star rating-stars" id="star-4" data-rating="4"></span>
            <span class="far fa-star rating-stars" id="star-5" data-rating="5"> </span>            
          </div>

          <div class="center-div-wrapper my-3">
            <span>{{ error }}</span>
          </div>

          <div class="center-div-wrapper">
            <button class="btn btn-submit" type="submit">Submit</button>
          </div>
        </form>
      </p>
    </div>

  </div>

</div>












{% endblock %}